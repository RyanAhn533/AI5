import numpy as np
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split,StratifiedKFold, KFold, cross_val_score
from sklearn.model_selection import cross_val_predict
from sklearn.metrics import r2_score, accuracy_score
from sklearn.model_selection import StratifiedKFold
from sklearn.svm import SVC
import pandas as pd
from sklearn.preprocessing import MinMaxScaler, StandardScaler
from sklearn.utils import all_estimators
import sklearn as sk
import warnings
warnings.filterwarnings('ignore')

#cross val score - 교차검증점수
# 5개로 짜른 데이터들마다 교차 검증 점수를 매긴다

#1. 데이터
x, y = load_iris(return_X_y=True)

x_train, x_test, y_train, y_test = train_test_split(x, y, shuffle=True,
                                                    random_state=123, train_size=0.8,
                                                    stratify=y)

scaler = StandardScaler()
x_train = scaler.fit_transform(x_train)
x_test = scaler.fit_transform(x_test)

all = all_estimators(type_filter='classifier')
all1 = all_estimators(type_filter='regressor')

print('all Algorithms :', all)
print('모델의 갯수 :', len(all)) # 43
print('모델의 갯수 :', len(all1)) # 55
print('sk 버전', sk.__version__)
kfold = StratifiedKFold(n_splits=5, shuffle=True, random_state=777)
for name, model in all:
    try:
        model = model()
        scores = cross_val_predict(model, x_train, y_train, cv=kfold)
        print('=================================')
        print("ACC : ", scores, '\n 평균 ACC ', round(np.mean(scores), 4))
        y_predict = cross_val_predict(model, x_test, y_test, cv=kfold)
        acc = accuracy_score(y_test, y_predict)
        model.fit(x_train, y_train)
        print('cross_val_predict ACC :', acc)
    except:
            print(name, '바보래용')
            
'''
모델의 갯수 : 43
모델의 갯수 : 55
sk 버전 1.5.1
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 1 0 2 0 2 1 0 0 1 2 1 1 1 0 2 1 2 1 2 2 1 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 1 2 0 1 0 0 1 1 2 1 2 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  0.9833
cross_val_predict ACC : 1.0
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 2 1 2 2 1 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 1 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  1.0
cross_val_predict ACC : 0.9666666666666667
=================================
ACC :  [1 0 2 0 0 2 0 0 2 2 0 0 0 2 0 2 0 2 2 0 0 2 2 2 1 2 0 2 1 2 2 2 2 0 0 2 2
 1 1 1 0 0 2 2 2 2 0 0 0 0 2 2 2 1 2 0 2 1 0 2 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 1 2 0 0 0 0 1 1 2 2 2 2 2 2 0 1 0 1 0 0 0 2 1 1 2 0 0 2 2 2 2 2
 1 0 2 0 0 1 2 0 2]
 평균 ACC  1.0583
cross_val_predict ACC : 0.5666666666666667
=================================
ACC :  [1 0 1 0 0 2 0 0 2 2 0 0 0 2 0 2 0 2 1 0 0 2 2 2 1 1 0 2 1 1 1 2 2 1 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 2 2 2 1 2 0 2 2 0 1 0 1 2 0 0 0 1 1 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 2 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 2 1
 1 0 1 1 0 2 2 0 1]
 평균 ACC  1.0417
cross_val_predict ACC : 0.8
CategoricalNB 바보래용
ClassifierChain 바보래용
ComplementNB 바보래용
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 1 0 2 0 2 1 0 0 1 2 1 1 1 0 2 1 1 1 2 2 1 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 2 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  0.9833
cross_val_predict ACC : 1.0
=================================
ACC :  [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0]
 평균 ACC  0.0
cross_val_predict ACC : 0.3333333333333333
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 2 1 2 2 1 0 2 2
 1 2 1 0 0 1 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 1 0 2 1 1 2 2
 0 2 0 1 2 1 2 0 1 0 0 1 1 2 1 2 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 2 0 0 1 2 0 1]
 평균 ACC  0.9917
cross_val_predict ACC : 0.8333333333333334
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 1 1 2 2 1 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 1 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  0.9917
cross_val_predict ACC : 0.9666666666666667
FixedThresholdClassifier 바보래용
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 1 1 2 2 1 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 2 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  1.0
cross_val_predict ACC : 0.9333333333333333
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 1 1 2 2 1 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 1 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 2 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  0.9917
cross_val_predict ACC : 0.9333333333333333
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 1 0 2 0 2 1 0 0 1 2 1 1 1 0 2 1 1 1 2 2 1 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 2 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  0.9833
cross_val_predict ACC : 0.9333333333333333
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 1 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 2 1 2 2 1 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 2 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  1.0
cross_val_predict ACC : 0.3333333333333333
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 1 1 2 2 1 0 2 1
 1 2 1 0 0 1 2 2 2 0 1 0 0 1 2 2 1 1 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 1 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  0.975
cross_val_predict ACC : 0.9333333333333333
=================================
ACC :  [1 0 2 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 2 2 2 1 1 0 2 1 1 1 2 2 1 0 2 1
 1 2 1 0 0 1 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 1 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 1 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 1 0 2 2 0 1]
 평균 ACC  1.0
cross_val_predict ACC : 0.8333333333333334
=================================
ACC :  [1 0 2 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 2 2 2 1 1 0 2 1 1 1 2 2 1 0 2 1
 1 2 1 0 0 1 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 1 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 1 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 1 0 2 2 0 1]
 평균 ACC  1.0
cross_val_predict ACC : 0.8333333333333334
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 1 1 2 2 1 0 2 2
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 1 2 2 2 0 1 1 1 0 0 1 2 1 2 2 0 0 2 1 2 1 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  1.0083
cross_val_predict ACC : 1.0
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 1 1 2 2 1 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 1 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 2 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 1 0 2 2 0 1]
 평균 ACC  1.0
cross_val_predict ACC : 0.8666666666666667
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 1 1 2 2 1 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 1 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  0.9917
cross_val_predict ACC : 0.9
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 1 1 2 2 1 0 2 2
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 1 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  1.0
cross_val_predict ACC : 0.9333333333333333
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 2 1 2 2 1 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 1 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  1.0
cross_val_predict ACC : 0.9
MultiOutputClassifier 바보래용
MultinomialNB 바보래용
=================================
ACC :  [1 0 1 0 0 2 0 0 2 2 0 0 0 2 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 1 1 2 2 1 0 2 1
 1 2 1 0 0 1 2 2 2 0 1 0 0 2 2 2 1 2 0 2 1 0 1 0 1 1 0 0 0 1 1 0 2 1 1 2 2
 0 2 0 1 1 1 2 0 1 0 0 1 1 2 2 2 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 2 1
 1 0 1 0 0 1 2 0 1]
 평균 ACC  0.9833
cross_val_predict ACC : 0.7666666666666667
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 1 1 2 2 1 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 1 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 1 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  0.9833
cross_val_predict ACC : 0.9
OneVsOneClassifier 바보래용
OneVsRestClassifier 바보래용
OutputCodeClassifier 바보래용
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 1 2 1 0 0 1 2 2 1 1 0 2 1 1 1 2 2 1 0 2 1
 1 2 1 0 0 1 2 1 2 0 1 0 0 2 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 1 0 2 1 1 2 2
 0 2 0 1 1 1 2 0 1 0 0 1 1 2 1 1 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 1 1 1 2 0 1]
 평균 ACC  0.975
cross_val_predict ACC : 0.8666666666666667
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 1 1 2 2 1 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 2 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 1 0 2 0 1 2 2
 0 2 0 1 1 2 2 0 1 0 0 1 1 2 1 2 2 2 2 0 1 1 0 0 0 1 2 1 1 2 0 0 2 1 2 0 1
 1 0 1 1 0 2 2 0 1]
 평균 ACC  0.975
cross_val_predict ACC : 0.7666666666666667
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 1 1 2 2 1 0 2 2
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 1 2 2 2 0 1 1 1 0 0 1 2 1 2 2 0 0 2 1 2 1 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  1.0083
cross_val_predict ACC : 0.9666666666666667
RadiusNeighborsClassifier 바보래용
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 1 2 1 1 1 0 2 1 1 1 2 2 1 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 2 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  0.9917
cross_val_predict ACC : 0.9666666666666667
=================================
ACC :  [1 0 1 0 0 2 0 0 2 2 0 0 0 2 0 2 0 2 2 0 0 2 2 2 1 1 0 2 1 1 2 2 2 1 0 2 1
 1 2 2 0 0 2 2 2 2 0 1 0 0 2 2 2 1 2 0 2 2 0 1 0 1 2 0 0 0 1 1 0 2 2 1 2 2
 0 2 0 1 1 2 2 0 1 0 0 1 1 2 2 2 2 1 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 2 2
 1 0 1 1 0 2 2 0 2]
 평균 ACC  1.0833
cross_val_predict ACC : 0.8
=================================
ACC :  [1 0 1 0 0 2 0 0 2 2 0 0 0 2 0 2 0 2 2 0 0 2 2 2 1 1 0 2 1 2 2 2 2 1 0 2 1
 1 2 2 0 0 2 2 2 2 0 1 0 0 2 2 2 1 2 0 2 2 0 1 0 1 2 0 0 0 1 1 0 2 2 1 2 2
 0 2 0 1 1 2 2 0 1 0 0 1 1 2 2 2 2 1 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 2 2
 1 0 1 1 0 2 2 0 2]
 평균 ACC  1.0917
cross_val_predict ACC : 0.8
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 1 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 1 1 2 2 0 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 2 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 1 2 2 0 1 0 0 1 1 2 1 1 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 0 2 0 1
 1 0 1 0 0 2 2 0 1]
 평균 ACC  0.95
cross_val_predict ACC : 0.9
=================================
ACC :  [1 0 1 0 0 2 0 0 2 1 0 0 0 2 0 2 0 2 1 0 0 1 2 2 1 1 0 2 1 2 1 2 2 1 0 2 1
 1 2 1 0 0 2 2 2 2 0 1 0 0 1 2 2 1 1 0 2 2 0 1 0 1 1 0 0 0 1 2 0 2 1 1 2 2
 0 2 0 1 2 2 2 0 1 0 0 1 1 2 1 1 2 2 2 0 1 1 1 0 0 1 2 1 1 2 0 0 2 1 2 1 1
 1 0 1 1 0 2 2 0 1]
 평균 ACC  1.0
cross_val_predict ACC : 0.8666666666666667
StackingClassifier 바보래용
TunedThresholdClassifierCV 바보래용
VotingClassifier 바보래용
'''